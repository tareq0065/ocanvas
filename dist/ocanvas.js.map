{"version":3,"file":"ocanvas.js","sources":["../src/components/Layer.js","../node_modules/style-inject/dist/style-inject.es.js","../src/jscanvas.js","../util/useWindowDimensions.js","../src/Canvas/Canvas.js"],"sourcesContent":["import React, { useContext, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport '../Canvas/Canvas.css';\nimport { JsCanvas } from '../jscanvas';\n\nconst Layer = ({\n\tchildren,\n\tname,\n\tid,\n\tratio,\n\tkeyframes,\n\tstyle,\n\tplaySpeed,\n\tdelay,\n\titeration,\n}) => {\n\tconst baseName = name.replaceAll(' ', '_') + id;\n\n\tuseEffect(() => {\n\t\tconst newItem = JsCanvas.newItem(`.Layer-${baseName}`, {\n\t\t\tselector: true,\n\t\t\tdelay: delay,\n\t\t\tplaySpeed: playSpeed,\n\t\t});\n\t\tnewItem.set({\n\t\t\t...keyframes,\n\t\t\toptions: {\n\t\t\t\tdelay: delay,\n\t\t\t\titeration: iteration,\n\t\t\t\tplaySpeed: playSpeed,\n\t\t\t},\n\t\t});\n\t}, [name, keyframes, iteration]);\n\n\treturn (\n\t\t<div\n\t\t\tdata-testid={`Layer-${baseName}`}\n\t\t\tclassName={`Layer-${baseName}`}\n\t\t\tstyle={{\n\t\t\t\tposition: 'absolute',\n\t\t\t\twidth: ratio.width,\n\t\t\t\theight: ratio.height,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tbottom: 0,\n\t\t\t\tmargin: 'auto',\n\t\t\t\t...style,\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\nLayer.defaultProps = {\n\tname: 'animation',\n\tid: 1,\n\tratio: {\n\t\twidth: 1080,\n\t\theight: 720,\n\t},\n\tkeyframes: {},\n\tstyle: {},\n\tplaySpeed: 1,\n\tdelay: 0,\n\tchildren: <div />,\n\titeration: 'infinite',\n};\n\nLayer.propTypes = {\n\tname: PropTypes.string,\n\tid: PropTypes.number,\n\tratio: PropTypes.object,\n\tkeyframes: PropTypes.object,\n\tstyle: PropTypes.object,\n\tlayerStyle: PropTypes.object,\n\tplaySpeed: PropTypes.number,\n\tdelay: PropTypes.number || PropTypes.string,\n\tchildren: PropTypes.any,\n\titeration: PropTypes.any,\n};\n\nexport { Layer };\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { useEffect, useState, useReducer } from 'react';\nimport Scene, { EASE_IN_OUT } from 'scenejs';\n\nconst JsCanvas = new Scene(\n\t{},\n\t{\n\t\teasing: EASE_IN_OUT,\n\t\titerationCount: 1,\n\t\tselector: true,\n\t}\n).setTime(0);\n\nexport { JsCanvas };\n","import { useEffect, useState } from 'react';\n\nfunction getWindowDimensions() {\n\tconst { innerWidth: width, innerHeight: height } =\n\t\ttypeof window !== 'undefined' ? window : {};\n\treturn {\n\t\twidth,\n\t\theight,\n\t};\n}\n\nexport default function useWindowDimensions(\n\tcanvasContentRef,\n\tmaxWidth,\n\tmaxHeight\n) {\n\tconst [windowDimensions, setWindowDimensions] = useState(\n\t\tgetWindowDimensions()\n\t);\n\n\tuseEffect(() => {\n\t\tfunction handleResize() {\n\t\t\tlet theRatio = {\n\t\t\t\theight: getWindowDimensions().height / (16 / 9),\n\t\t\t\twidth: getWindowDimensions().width / (16 / 9),\n\t\t\t};\n\n\t\t\ttheRatio.scale = Math.min(\n\t\t\t\ttheRatio.width / maxWidth,\n\t\t\t\ttheRatio.height / maxHeight\n\t\t\t);\n\t\t\tsetWindowDimensions(theRatio);\n\t\t}\n\n\t\thandleResize();\n\n\t\twindow.addEventListener('resize', handleResize);\n\t\treturn () => window.removeEventListener('resize', handleResize);\n\t}, []);\n\n\treturn windowDimensions;\n}\n","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport './Canvas.css';\nimport useWindowDimensions from '../../util/useWindowDimensions';\nimport { JsCanvas, useJsCanvas } from '../jscanvas';\n\nconst CanvasContainer = ({\n\tchildren,\n\twidth,\n\theight,\n\tjsCanva,\n\tautoPlay,\n\tcontrols,\n\tplaying,\n\tfullWidth,\n\tanimationDuration,\n}) => {\n\tconst canvasRef = useRef(null);\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [progress, setProgress] = useState(0);\n\n\tconst {\n\t\theight: windowHeight,\n\t\twidth: windowWidth,\n\t\tscale,\n\t} = useWindowDimensions(canvasRef, width, height);\n\n\tuseEffect(() => {\n\t\tlet duration = JsCanvas.getDuration();\n\t\tjsCanva(JsCanvas);\n\t\tanimationDuration(duration);\n\n\t\tif (autoPlay) {\n\t\t\tJsCanvas.play();\n\t\t\tsetIsPlaying(true);\n\t\t}\n\n\t\tJsCanvas.on('play', (e) => {\n\t\t\tsetIsPlaying(true);\n\t\t});\n\t\tJsCanvas.on('paused', (e) => {\n\t\t\tsetIsPlaying(false);\n\t\t});\n\t\tJsCanvas.on('animate', (e) => {\n\t\t\tsetProgress((100 * e.time) / duration);\n\t\t});\n\t\tplaying({\n\t\t\tplaying: isPlaying,\n\t\t\tprogress: progress,\n\t\t});\n\t}, [isPlaying, progress]);\n\n\treturn (\n\t\t<div id=\"canvasContainer\">\n\t\t\t<div className=\"Canvas\" id=\"recorderCanvas\" ref={canvasRef}>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"CanvasInner\"\n\t\t\t\t\tstyle={\n\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t\t\t\theight: windowHeight,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tid=\"Composition\"\n\t\t\t\t\t\tclassName=\"Composition\"\n\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t\t\t\ttransform: `translate(-50%, -50%) scale(${\n\t\t\t\t\t\t\t\t\t\t\tscale ? scale : 1\n\t\t\t\t\t\t\t\t\t\t})`,\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"Layers\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{controls && (\n\t\t\t\t<div className=\"playerWrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"player\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`${isPlaying ? 'pause' : 'play'}`}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tJsCanvas.isPaused() ? JsCanvas.play() : JsCanvas.pause();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName=\"progress\"\n\t\t\t\t\t\t\ttype=\"range\"\n\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\tJsCanvas.pause();\n\t\t\t\t\t\t\t\tJsCanvas.setTime(e.target.value + '%');\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tvalue={progress.toString()}\n\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\tmax=\"100\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nconst Canvas = ({\n\tchildren,\n\twidth,\n\theight,\n\tjsCanva,\n\tautoPlay,\n\tcontrols,\n\tplaying,\n\tfullWidth,\n\tanimationDuration,\n}) => {\n\treturn (\n\t\t<CanvasContainer\n\t\t\theight={height}\n\t\t\twidth={width}\n\t\t\tautoPlay={autoPlay}\n\t\t\tcontrols={controls}\n\t\t\tplaying={playing}\n\t\t\tjsCanva={jsCanva}\n\t\t\tfullWidth={fullWidth}\n\t\t\tanimationDuration={animationDuration}\n\t\t>\n\t\t\t{children}\n\t\t</CanvasContainer>\n\t);\n};\n\nCanvas.defaultProps = {\n\twidth: 1920,\n\theight: 1080,\n\tchildren: [],\n\tautoPlay: false,\n\tcontrols: true,\n\tplaying: () => {},\n\tjsCanva: () => {},\n\tfullWidth: false,\n\tanimationDuration: () => {},\n};\n\nCanvas.propTypes = {\n\twidth: PropTypes.number,\n\theight: PropTypes.number,\n\tchildren: PropTypes.any,\n\tautoPlay: PropTypes.bool,\n\tcontrols: PropTypes.bool,\n\tplaying: PropTypes.func,\n\tjsCanva: PropTypes.any,\n\tfullWidth: PropTypes.bool,\n\tanimationDuration: PropTypes.func,\n};\n\nexport { Canvas };\n"],"names":["Layer","_ref","children","name","id","ratio","keyframes","style","playSpeed","delay","iteration","baseName","replaceAll","useEffect","JsCanvas","newItem","concat","selector","set","_objectSpread","options","React","createElement","data-testid","className","position","width","height","left","right","top","bottom","margin","css","insertAt","ref","document","head","getElementsByTagName","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","Scene","easing","EASE_IN_OUT","iterationCount","setTime","getWindowDimensions","window","innerWidth","innerHeight","defaultProps","propTypes","PropTypes","string","number","object","layerStyle","any","CanvasContainer","maxWidth","maxHeight","setWindowDimensions","jsCanva","autoPlay","controls","playing","fullWidth","animationDuration","canvasRef","useRef","isPlaying","_useState2","_slicedToArray","useState","setIsPlaying","progress","_useState4","setProgress","windowDimensions","handleResize","theRatio","scale","Math","min","addEventListener","removeEventListener","windowHeight","windowWidth","duration","getDuration","play","on","e","time","transform","onClick","isPaused","pause","onChange","target","value","toString","max","Canvas","_ref2","bool","func"],"mappings":"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"}