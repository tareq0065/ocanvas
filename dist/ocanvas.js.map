{"version":3,"file":"ocanvas.js","sources":["../src/components/Layer.js","../node_modules/style-inject/dist/style-inject.es.js","../util/useJsCanvas.js","../util/useWindowDimensions.js","../src/Canvas/Canvas.js"],"sourcesContent":["import React, { useContext, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport '../Canvas/Canvas.scss';\nimport { JsCanvasContext } from '../../util/useJsCanvas';\n\nconst Layer = ({\n\tchildren,\n\tname,\n\tid,\n\tratio,\n\tkeyframes,\n\tstyle,\n\tlayerStyle,\n\tplaySpeed,\n\tdelay,\n\tautoPlay,\n\titeration,\n\tuid,\n}) => {\n\tconst jsCanvas = useContext(JsCanvasContext);\n\n\tuseEffect(() => {\n\t\tconst newItem = jsCanvas.newItem(\n\t\t\t`.Layer-${name.replaceAll(' ', '_') + uid}`,\n\t\t\t{ selector: true }\n\t\t);\n\t\tnewItem.set({\n\t\t\t...keyframes,\n\t\t\toptions: {\n\t\t\t\tdelay: delay,\n\t\t\t\titeration: iteration,\n\t\t\t},\n\t\t});\n\t}, []);\n\n\treturn (\n\t\t<div\n\t\t\tdata-testid={`Layer-${name.replaceAll(' ', '_') + uid}`}\n\t\t\tstyle={{\n\t\t\t\tmargin: 'auto',\n\t\t\t\t...style,\n\t\t\t}}\n\t\t\tclassName={`Layer-${name.replaceAll(' ', '_') + uid}`}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\nLayer.defaultProps = {\n\tname: 'animation',\n\tid: 1,\n\tratio: {\n\t\twidth: 1080,\n\t\theight: 720,\n\t},\n\tkeyframes: {},\n\tstyle: {},\n\tlayerStyle: {},\n\tplaySpeed: 1,\n\tdelay: 0,\n\tautoPlay: false,\n\tchildren: <div />,\n\titeration: 'infinite',\n\tuid: Math.floor(Math.random() * 1000 + 1),\n};\n\nLayer.propTypes = {\n\tname: PropTypes.string,\n\tid: PropTypes.number,\n\tratio: PropTypes.object,\n\tkeyframes: PropTypes.object,\n\tstyle: PropTypes.object,\n\tlayerStyle: PropTypes.object,\n\tplaySpeed: PropTypes.number,\n\tdelay: PropTypes.number,\n\tautoPlay: PropTypes.bool,\n\tchildren: PropTypes.any,\n\titeration: PropTypes.any,\n};\n\nexport { Layer };\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { createContext, useEffect, useState } from 'react';\nimport Scene from 'scenejs';\n\nconst JsCanvasContext = createContext(null);\n\nexport { JsCanvasContext };\n","import { useEffect, useState } from 'react';\n\nfunction getWindowDimensions() {\n\tconst { innerWidth: width, innerHeight: height } =\n\t\ttypeof window !== 'undefined' ? window : {};\n\treturn {\n\t\twidth,\n\t\theight,\n\t};\n}\n\nexport default function useWindowDimensions(\n\tcanvasContentRef,\n\tmaxWidth,\n\tmaxHeight\n) {\n\tconst [windowDimensions, setWindowDimensions] = useState(\n\t\tgetWindowDimensions()\n\t);\n\n\tuseEffect(() => {\n\t\tfunction handleResize() {\n\t\t\tlet theRatio = {\n\t\t\t\theight: getWindowDimensions().height / (16 / 9),\n\t\t\t\twidth: getWindowDimensions().width / (16 / 9),\n\t\t\t};\n\n\t\t\ttheRatio.scale = Math.min(\n\t\t\t\ttheRatio.width / maxWidth,\n\t\t\t\ttheRatio.height / maxHeight\n\t\t\t);\n\t\t\tsetWindowDimensions(theRatio);\n\t\t}\n\n\t\thandleResize();\n\n\t\twindow.addEventListener('resize', handleResize);\n\t\treturn () => window.removeEventListener('resize', handleResize);\n\t}, []);\n\n\treturn windowDimensions;\n}\n","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport './Canvas.scss';\nimport useWindowDimensions from '../../util/useWindowDimensions';\nimport Scene from 'scenejs';\nimport { JsCanvasContext } from '../../util/useJsCanvas';\n\nconst CanvasContainer = ({\n\tchildren,\n\twidth,\n\theight,\n\tjsCanva,\n\tautoPlay,\n\tcontrols,\n\tfullWidth,\n}) => {\n\tconst jsCanvas = useContext(JsCanvasContext);\n\tconst canvasRef = useRef(null);\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [progress, setProgress] = useState(0);\n\tconst {\n\t\theight: windowHeight,\n\t\twidth: windowWidth,\n\t\tscale,\n\t} = useWindowDimensions(canvasRef, width, height);\n\n\tuseEffect(() => {\n\t\tlet duration = jsCanvas.getDuration();\n\t\tjsCanva(jsCanvas);\n\n\t\tif (autoPlay) {\n\t\t\tjsCanvas.play();\n\t\t\tsetIsPlaying(true);\n\t\t}\n\n\t\tjsCanvas.on('play', (e) => {\n\t\t\tsetIsPlaying(true);\n\t\t});\n\t\tjsCanvas.on('paused', (e) => {\n\t\t\tsetIsPlaying(false);\n\t\t});\n\t\tjsCanvas.on('animate', (e) => {\n\t\t\tsetProgress((100 * e.time) / duration);\n\t\t});\n\t}, [autoPlay]);\n\n\treturn (\n\t\t<div id=\"canvasContainer\">\n\t\t\t<div className=\"Canvas\" id=\"recorderCanvas\" ref={canvasRef}>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"CanvasInner\"\n\t\t\t\t\tstyle={\n\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t\t\t\theight: windowHeight,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tid=\"Composition\"\n\t\t\t\t\t\tclassName=\"Composition\"\n\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t\t\t\ttransform: `translate(-50%, -50%) scale(${\n\t\t\t\t\t\t\t\t\t\t\tscale ? scale : 1\n\t\t\t\t\t\t\t\t\t\t})`,\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"Layers\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{controls && (\n\t\t\t\t<div className=\"playerWrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"player\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`${isPlaying ? 'pause' : 'play'}`}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tjsCanvas.isPaused() ? jsCanvas.play() : jsCanvas.pause();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName=\"progress\"\n\t\t\t\t\t\t\ttype=\"range\"\n\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\tjsCanvas.pause();\n\t\t\t\t\t\t\t\tjsCanvas.setTime(e.target.value + '%');\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tvalue={progress.toString()}\n\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\tmax=\"100\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nconst Canvas = ({\n\tchildren,\n\twidth,\n\theight,\n\tjsCanva,\n\tautoPlay,\n\tcontrols,\n\tfullWidth,\n}) => {\n\treturn (\n\t\t<JsCanvasContext.Provider\n\t\t\tvalue={new Scene(\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\teasing: Scene.EASE_IN_OUT,\n\t\t\t\t\titerationCount: 1,\n\t\t\t\t\tselector: true,\n\t\t\t\t}\n\t\t\t).setTime(0)}\n\t\t>\n\t\t\t<CanvasContainer\n\t\t\t\theight={height}\n\t\t\t\twidth={width}\n\t\t\t\tautoPlay={autoPlay}\n\t\t\t\tcontrols={controls}\n\t\t\t\tjsCanva={jsCanva}\n\t\t\t\tfullWidth={fullWidth}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</CanvasContainer>\n\t\t</JsCanvasContext.Provider>\n\t);\n};\n\nCanvas.defaultProps = {\n\twidth: 1920,\n\theight: 1080,\n\tchildren: [],\n\tautoPlay: false,\n\tcontrols: true,\n\tjsCanva: () => {},\n\tfullWidth: false,\n};\n\nCanvas.propTypes = {\n\twidth: PropTypes.number,\n\theight: PropTypes.number,\n\tchildren: PropTypes.any,\n\tautoPlay: PropTypes.bool,\n\tcontrols: PropTypes.bool,\n\tjsCanva: PropTypes.any,\n\tfullWidth: PropTypes.bool,\n};\n\nexport { Canvas };\n"],"names":["Layer","_ref","children","name","keyframes","id","ratio","style","delay","layerStyle","playSpeed","iteration","autoPlay","uid","jsCanvas","useContext","JsCanvasContext","useEffect","newItem","replaceAll","selector","set","_objectSpread","options","React","createElement","data-testid","margin","className","concat","css","insertAt","ref","document","head","getElementsByTagName","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","createContext","getWindowDimensions","window","width","innerWidth","height","innerHeight","defaultProps","Math","floor","random","propTypes","PropTypes","string","number","object","bool","any","CanvasContainer","maxWidth","maxHeight","setWindowDimensions","jsCanva","controls","fullWidth","canvasRef","useRef","isPlaying","_useState2","_slicedToArray","useState","setIsPlaying","progress","_useState4","setProgress","windowDimensions","handleResize","theRatio","scale","min","addEventListener","removeEventListener","windowHeight","windowWidth","duration","getDuration","play","on","e","time","transform","onClick","isPaused","pause","onChange","setTime","target","value","toString","max","Canvas","_ref2","Provider","Scene","easing","EASE_IN_OUT","iterationCount"],"mappings":"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"}